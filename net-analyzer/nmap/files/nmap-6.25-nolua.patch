diff -ub -rub nmap-6.25.org/Target.cc nmap-6.25/Target.cc
--- nmap-6.25.org/Target.cc	2012-12-03 12:08:45.000000000 +0400
+++ nmap-6.25/Target.cc	2012-12-03 11:59:23.000000000 +0400
@@ -162,10 +162,12 @@
 
 Target::~Target() {
   FreeInternal();
+#ifndef NOLUA
   while (!scriptResults.empty()) {
     scriptResults.front().clear();
     scriptResults.pop_front();
   }
+#endif
 }
 
 void Target::FreeInternal() {
diff -ub -rub nmap-6.25.org/output.cc nmap-6.25/output.cc
--- nmap-6.25.org/output.cc	2012-12-03 12:08:45.000000000 +0400
+++ nmap-6.25/output.cc	2012-12-03 11:55:16.000000000 +0400
@@ -2612,7 +2612,7 @@
     }
   }
 }
-
+#ifndef NOLUA
 /*This is a helper function to determine the ordering of the script results
   based on their id */
 bool comparescriptids(ScriptResult first, ScriptResult second){
@@ -2625,5 +2625,4 @@
     else
         return false;
 }
-
-
+#endif
diff -ub -rub nmap-6.25.org/output.h nmap-6.25/output.h
--- nmap-6.25.org/output.h	2012-12-03 12:08:45.000000000 +0400
+++ nmap-6.25/output.h	2012-12-03 11:54:49.000000000 +0400
@@ -253,8 +253,10 @@
    were found. */
 void printdatafilepaths();
 
+#ifndef NOLUA
 /*This is a helper function to determine the ordering of the script results
   based on their id */
 bool comparescriptids(ScriptResult first, ScriptResult second);
+#endif
 
 #endif /* OUTPUT_H */
diff -ub -rub nmap-6.25.org/portlist.cc nmap-6.25/portlist.cc
--- nmap-6.25.org/portlist.cc	2012-12-03 12:08:45.000000000 +0400
+++ nmap-6.25/portlist.cc	2012-12-03 12:11:07.000000000 +0400
@@ -143,7 +143,7 @@
       delete service;
   }
 }
-
+#ifndef NOLUA
 void Port::freeScriptResults(void)
 {
     while (!scriptResults.empty()) {
@@ -151,7 +151,7 @@
         scriptResults.pop_front();
     }
 }
-
+#endif
 /* Fills in namebuf (as long as there is space in buflen) with the
    Name nmap normal output will use to describe the port.  This takes
    into account to confidence level, any SSL tunneling, etc.  Truncates
diff -ub -rub nmap-6.25.org/portlist.h nmap-6.25/portlist.h
--- nmap-6.25.org/portlist.h	2012-12-03 12:08:45.000000000 +0400
+++ nmap-6.25/portlist.h	2012-12-03 11:57:35.000000000 +0400
@@ -171,7 +171,9 @@
  public:
   Port();
   void freeService(bool del_service);
+#ifndef NOLUA
   void freeScriptResults(void);
+#endif
   void getNmapServiceName(char *namebuf, int buflen) const;
 
   u16 portno;
